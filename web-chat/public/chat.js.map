{"version":3,"file":"chat.js","mappings":";;;;;;;;;;;;;;;;;;;;AAAA;AACO,IAAMA,MAAM,GAAG;EACpBC,YAAY,EAAE,cAAc;EAC5BC,iBAAiB,EAAE,mBAAmB;EACtCC,iBAAiB,EAAE,mBAAmB;EACtCC,aAAa,EAAE,eAAe;EAC9BC,YAAY,EAAE,UAAU,CAAE;AAC5B,CAAC;;AAEM,IAAMC,MAAM,GAAG;EACpBC,aAAa,EAAE,cAAc;EAC7BC,UAAU,EAAE;AACd,CAAC;AAEM,IAAMC,QAAQ,GAAAC,eAAA,CAAAA,eAAA,CAAAA,eAAA,CAAAA,eAAA,CAAAA,eAAA,KAElBJ,MAAM,CAACC,aAAa,EAAG,sDAAsD,GAE7EP,MAAM,CAACE,iBAAiB,EAAG,kFAAkF,GAC7GF,MAAM,CAACG,iBAAiB,EAAG,wDAAwD,GACnFH,MAAM,CAACI,aAAa,EAAG,6BAA6B,cAC5C,yCAAyC,CACnD;;;;;;;;;;;;;;;;;;;;;;;ACrB6B;AAC4B;AAC2C;AACY;AAC5E;AAE9B,SAASuB,iBAAiBA,CAAAC,IAAA,EAAoB;EAAA,IAAhBC,KAAK,GAAAD,IAAA,CAALC,KAAK;IAAEC,MAAM,GAAAF,IAAA,CAANE,MAAM;EAC9CA,MAAM,CAACC,gBAAgB,CAAE,QAAQ,EAAE,UAAAC,CAAC,EAAI;IACpC,IAAG,CAACA,CAAC,CAACC,MAAM,CAACC,SAAS,CAACC,QAAQ,CAAC,aAAa,CAAC,EAAC;MAC3C;IACJ;IAEAH,CAAC,CAACI,cAAc,CAAC,CAAC;IAElB,IAAMC,QAAQ,GAAGC,QAAQ,CAACC,aAAa,CAAC,WAAW,CAAC,CAACC,KAAK;IAC1D;IACAzB,qDAAU,CAACsB,QAAQ,CAAC,CACnBI,IAAI,CAAE,UAAAC,QAAQ,EAAI;MACf,IAAMC,KAAK,GAAGD,QAAQ,CAACC,KAAK;MAC5BvB,6CAAK,CAAC;QAACiB,QAAQ,EAARA,QAAQ;QAAEM,KAAK,EAALA;MAAK,CAAC,CAAC;MACxBhC,mDAAM,CAAE;QAACkB,KAAK,EAALA,KAAK;QAAEC,MAAM,EAANA;MAAM,CAAE,CAAC;MAEzB,OAAOZ,2DAAgB,CAAC,CAAC;IAC7B,CAAC,CAAC,SACI,CAAE,UAAA0B,GAAG,EAAI;MACXlB,gDAAQ,CAAC,CAAAkB,GAAG,aAAHA,GAAG,uBAAHA,GAAG,CAAEC,KAAK,KAAI,OAAO,CAAC;MAC/BlC,mDAAM,CAAC;QAAEkB,KAAK,EAALA,KAAK;QAAEC,MAAM,EAANA;MAAO,CAAC,CAAC;MACzB,OAAOgB,OAAO,CAACC,MAAM,CAACH,GAAG,CAAC;IAC5B,CAAC,CAAC,CACHH,IAAI,CAAC,UAAAO,QAAQ,EAAI;MACd1B,sDAAc,CAAC0B,QAAQ,CAAC;MACxBnC,sDAAY,CAACgB,KAAK,CAAC;MACnB,OAAOV,yDAAc,CAAC,CAAC;IAC3B,CAAC,CAAC,CACDsB,IAAI,CAAC,UAAAQ,KAAK,EAAI;MACX1B,oDAAY,CAAC0B,KAAK,CAAC;MACnBnC,mDAAS,CAACe,KAAK,CAAC;MAChB;IACJ,CAAC,CAAC,SACI,CAAE,UAAAe,GAAG,EAAI;MACXlB,gDAAQ,CAAC,CAAAkB,GAAG,aAAHA,GAAG,uBAAHA,GAAG,CAAEC,KAAK,KAAI,OAAO,CAAC;MAC/BlC,mDAAM,CAAC;QAAEkB,KAAK,EAALA,KAAK;QAAEC,MAAM,EAANA;MAAO,CAAC,CAAC;MACzB;IACF,CAAC,CAAC;EACR,CAAC,CAAC;AACN;AAEO,SAASoB,kBAAkBA,CAAAC,KAAA,EAAoB;EAAA,IAAhBtB,KAAK,GAAAsB,KAAA,CAALtB,KAAK;IAAEC,MAAM,GAAAqB,KAAA,CAANrB,MAAM;EAC/CA,MAAM,CAACC,gBAAgB,CAAC,OAAO,EAAE,UAAAC,CAAC,EAAI;IAClC,IAAG,CAACA,CAAC,CAACC,MAAM,CAACC,SAAS,CAACC,QAAQ,CAAC,gBAAgB,CAAC,EAAC;MAC9C;IACJ;IAEAH,CAAC,CAACI,cAAc,CAAC,CAAC;IAClBf,8CAAM,CAAC,CAAC;IACRL,sDAAW,CAAC,CAAC,SACP,CAAE,UAAA4B,GAAG,EAAI;MACXlB,gDAAQ,CAAC,CAAAkB,GAAG,aAAHA,GAAG,uBAAHA,GAAG,CAAEC,KAAK,KAAI,OAAO,CAAC;MAC/BlC,mDAAM,CAAC;QAAEkB,KAAK,EAALA,KAAK;QAAEC,MAAM,EAANA;MAAO,CAAC,CAAC;IAC3B,CAAC,CAAC,CACHW,IAAI,CAAE,UAAAC,QAAQ,EAAI;MACf/B,mDAAM,CAAE;QAAEkB,KAAK,EAALA,KAAK;QAAEC,MAAM,EAANA;MAAM,CAAC,CAAC;IAC7B,CAAC,CAAC;EACN,CAAC,CAAC;AACN;AAEO,SAASsB,uBAAuBA,CAAAC,KAAA,EAAmB;EAAA,IAAfxB,KAAK,GAAAwB,KAAA,CAALxB,KAAK;IAAEC,MAAM,GAAAuB,KAAA,CAANvB,MAAM;EACpDA,MAAM,CAACC,gBAAgB,CAAC,QAAQ,EAAE,UAAAC,CAAC,EAAI;IACnC,IAAG,CAACA,CAAC,CAACC,MAAM,CAACC,SAAS,CAACC,QAAQ,CAAC,YAAY,CAAC,EAAC;MAC1C;IACJ;IAEAH,CAAC,CAACI,cAAc,CAAC,CAAC;IAElB,IAAMkB,OAAO,GAAGxB,MAAM,CAACS,aAAa,CAAC,gBAAgB,CAAC,CAACC,KAAK;IAC5DV,MAAM,CAACS,aAAa,CAAC,gBAAgB,CAAC,CAACC,KAAK,GAAG,EAAE;IACjDvB,uDAAY,CAACqC,OAAO,CAAC,SACf,CAAE,UAAAV,GAAG,EAAI;MACX,IAAI,CAAAA,GAAG,aAAHA,GAAG,uBAAHA,GAAG,CAAEC,KAAK,KAAI7C,8CAAM,CAACC,YAAY,EAAG;QACpCyB,gDAAQ,CAAC,CAAAkB,GAAG,aAAHA,GAAG,uBAAHA,GAAG,CAAEC,KAAK,KAAI,OAAO,CAAC;QAC/BxB,8CAAM,CAAC,CAAC;QACRV,mDAAM,CAAC;UAAEkB,KAAK,EAALA,KAAK;UAAEC,MAAM,EAANA;QAAO,CAAC,CAAC;QACzB;MACF;MACFJ,gDAAQ,CAAC,CAAAkB,GAAG,aAAHA,GAAG,uBAAHA,GAAG,CAAEC,KAAK,KAAI,OAAO,CAAC;MAC/BlC,mDAAM,CAAC;QAAEkB,KAAK,EAALA,KAAK;QAAEC,MAAM,EAANA;MAAO,CAAC,CAAC;IAC3B,CAAC,CAAC,CACHW,IAAI,CAAE,UAAAC,QAAQ,EAAI;MACf,OAAOxB,2DAAgB,CAAC,CAAC;IAC7B,CAAC,CAAC,CACDuB,IAAI,CAAE,UAAAC,QAAQ,EAAI;MACfpB,sDAAc,CAACoB,QAAQ,CAAC;MACxB/B,mDAAM,CAAE;QAAEkB,KAAK,EAALA,KAAK;QAAEC,MAAM,EAANA;MAAM,CAAE,CAAC;IAC9B,CAAC,CAAC,SACI,CAAE,UAAAc,GAAG,EAAI;MACX,IAAI,CAAAA,GAAG,aAAHA,GAAG,uBAAHA,GAAG,CAAEC,KAAK,KAAI7C,8CAAM,CAACC,YAAY,EAAG;QACpCyB,gDAAQ,CAAC,CAAAkB,GAAG,aAAHA,GAAG,uBAAHA,GAAG,CAAEC,KAAK,KAAI,OAAO,CAAC;QAC/BxB,8CAAM,CAAC,CAAC;QACRV,mDAAM,CAAC;UAAEkB,KAAK,EAALA,KAAK;UAAEC,MAAM,EAANA;QAAO,CAAC,CAAC;QACzB;MACF;MACFJ,gDAAQ,CAAC,CAAAkB,GAAG,aAAHA,GAAG,uBAAHA,GAAG,CAAEC,KAAK,KAAI,OAAO,CAAC;MAC/BlC,mDAAM,CAAC;QAAEkB,KAAK,EAALA,KAAK;QAAEC,MAAM,EAANA;MAAO,CAAC,CAAC;IAC3B,CAAC,CAAC;EAER,CAAC,CAAC;AACN;AAEO,SAASyB,WAAWA,CAAAC,KAAA,EAAiB;EAAA,IAAf3B,KAAK,GAAA2B,KAAA,CAAL3B,KAAK;IAAEC,MAAM,GAAA0B,KAAA,CAAN1B,MAAM;EACtC,IAAM2B,SAAS,GAAGnB,QAAQ,CAACC,aAAa,CAAC,gBAAgB,CAAC;EAC1D,IAAI,CAACkB,SAAS,EAAE;IACZ;EACJ;EACAjC,wDAAgB,CAAC,CAAC;EAClBZ,oDAAM,CAAC;IAACiB,KAAK,EAALA;EAAK,CAAC,CAAC;EAEfX,2DAAgB,CAAC,CAAC,CACjBuB,IAAI,CAAE,UAAAC,QAAQ,EAAI;IACfpB,sDAAc,CAACoB,QAAQ,CAAC;IACxB7B,sDAAY,CAACgB,KAAK,CAAC;IACnB;EACJ,CAAC,CAAC,SACI,CAAE,UAAAe,GAAG,EAAI;IACX,IAAI,CAAAA,GAAG,aAAHA,GAAG,uBAAHA,GAAG,CAAEC,KAAK,KAAI7C,8CAAM,CAACC,YAAY,EAAG;MACpCoB,8CAAM,CAAC,CAAC;MACRV,mDAAM,CAAC;QAAEkB,KAAK,EAALA,KAAK;QAAEC,MAAM,EAANA;MAAO,CAAC,CAAC;MACzB;IACF;IACFJ,gDAAQ,CAAC,CAAAkB,GAAG,aAAHA,GAAG,uBAAHA,GAAG,CAAEC,KAAK,KAAI,OAAO,CAAC;IAC/BlC,mDAAM,CAAC;MAAEkB,KAAK,EAALA,KAAK;MAAEC,MAAM,EAANA;IAAO,CAAC,CAAC;EAC3B,CAAC,CAAC;AACR;AAEO,SAAS4B,QAAQA,CAAAC,KAAA,EAAoB;EAAA,IAAjB9B,KAAK,GAAA8B,KAAA,CAAL9B,KAAK;IAAEC,MAAM,GAAA6B,KAAA,CAAN7B,MAAM;EACpC,IAAM8B,MAAM,GAAGtB,QAAQ,CAACC,aAAa,CAAC,YAAY,CAAC;EACnD,IAAI,CAACqB,MAAM,EAAE;IACT;EACJ;EACAnC,qDAAa,CAAC,CAAC;EACfb,oDAAM,CAAC;IAACiB,KAAK,EAALA;EAAK,CAAC,CAAC;EACfV,yDAAc,CAAC,CAAC,CACfsB,IAAI,CAAE,UAAAC,QAAQ,EAAI;IACfnB,oDAAY,CAACmB,QAAQ,CAAC;IACtB5B,mDAAS,CAACe,KAAK,CAAC;EACpB,CAAC,CAAC,SACI,CAAE,UAAAe,GAAG,EAAI;IACXlB,gDAAQ,CAAC,CAAAkB,GAAG,aAAHA,GAAG,uBAAHA,GAAG,CAAEC,KAAK,KAAI,OAAO,CAAC;IAC/BlC,mDAAM,CAAC;MAAEkB,KAAK,EAALA,KAAK;MAAEC,MAAM,EAANA;IAAO,CAAC,CAAC;EAC3B,CAAC,CAAC;AACR;;;;;;;;;;;;;;ACtJA,IAAI+B,YAAY,GAAG,EAAE;AACrB,IAAIC,GAAG,GAAG,EAAE;AAEG,SAASnD,MAAMA,CAAAiB,IAAA,EAAoB;EAAA,IAAjBC,KAAK,GAAAD,IAAA,CAALC,KAAK;IAAEC,MAAM,GAAAF,IAAA,CAANE,MAAM;EAC1C+B,YAAY,GAAGhC,KAAK;EACpBiC,GAAG,GAAGhC,MAAM;EAEZ,IAAI,CAAC+B,YAAY,CAACE,UAAU,EAAE;IAC1BC,SAAS,CAAC,CAAC;EACf,CAAC,MACI;IACDC,QAAQ,CAAC,CAAC;EACd;AACJ;AAEA,SAASD,SAASA,CAAA,EAAG;EACjB,IAAIE,SAAS;EACb,IAAIL,YAAY,CAAChB,KAAK,EAAE;IACpBqB,SAAS,oCAAAC,MAAA,CAAkCN,YAAY,CAAChB,KAAK,YAAS;EAC1E;EACA,IAAMuB,IAAI,sMAAAD,MAAA,CAKQD,SAAS,MAAM,oSAMtB;EAEXJ,GAAG,CAACO,SAAS,GAAGD,IAAI;AACxB;AAEA,SAASH,QAAQA,CAAA,EAAG;EAChB,IAAIC,SAAS;EACb,IAAIL,YAAY,CAAChB,KAAK,EAAE;IACpBqB,SAAS,oCAAAC,MAAA,CAAkCN,YAAY,CAAChB,KAAK,YAAS;EAC1E;EACA,IAAMG,QAAQ,GAAGa,YAAY,CAACb,QAAQ;EACtC,IAAMsB,YAAY,GAAGtB,QAAQ,CAACuB,GAAG,CAAC,UAAAC,IAAI;IAAA,oGAAAL,MAAA,CAA2FK,IAAI,CAAC7B,KAAK,iCAAAwB,MAAA,CAA4BK,IAAI,CAACnC,QAAQ,wCAAA8B,MAAA,CAAmCK,IAAI,CAAClB,OAAO;EAAA,CAAoB,CAAC,CAACmB,IAAI,CAAC,EAAE,CAAC,4BAA4B;EAE7R,IAAIC,KAAK,GAAGb,YAAY,CAACa,KAAK;EAC9BA,KAAK,GAAGA,KAAK,CAACC,MAAM,CAAC,UAAAH,IAAI;IAAA,OAAIA,IAAI,CAACnC,QAAQ,KAAKwB,YAAY,CAACxB,QAAQ;EAAA,EAAC;EACrE,IAAMuC,UAAU,GAAGF,KAAK,CAACH,GAAG,CAAC,UAAAC,IAAI;IAAA,oFAAAL,MAAA,CAA4EK,IAAI,CAAC7B,KAAK,mCAAAwB,MAAA,CAA6BK,IAAI,CAACnC,QAAQ;EAAA,CAAoB,CAAC,CAACoC,IAAI,CAAC,GAAG,CAAC;EAEhM,IAAMI,WAAW,wZAKW;EAC5B,IAAMxD,MAAM,qDAAmD;EAC/D,IAAMyD,WAAW,kCAAAX,MAAA,CAAgCG,YAAY,EAAAH,MAAA,CAAGD,SAAS,MAAM,UAAO;EACtF,IAAMa,SAAS,8BAAAZ,MAAA,CAA4BS,UAAU,UAAO;EAE5D,IAAMR,IAAI,gLAAAD,MAAA,CAI8CN,YAAY,CAACmB,SAAS,qDAAAb,MAAA,CACxDN,YAAY,CAACxB,QAAQ,kJAAA8B,MAAA,CAIzBY,SAAS,4FAAAZ,MAAA,CAGT9C,MAAM,yYAAA8C,MAAA,CASNW,WAAW,4BAAAX,MAAA,CACXU,WAAW,iEAGlB;EAEXf,GAAG,CAACO,SAAS,GAAGD,IAAI;AACxB;;;;;;;;;;;;;;;;;;;ACtFO,SAASa,YAAYA,CAAA,EAAE;EAC1B,OAAOC,KAAK,CAAC,iBAAiB,CAAC,SACzB,CAAE;IAAA,OAAMpC,OAAO,CAACC,MAAM,CAAC;MAAEF,KAAK,EAAE;IAAe,CAAC,CAAC;EAAA,EAAC,CACvDJ,IAAI,CAAE,UAAAC,QAAQ,EAAI;IACf,IAAIA,QAAQ,CAACyC,EAAE,EAAE;MACb,OAAOzC,QAAQ,CAAC0C,IAAI,CAAC,CAAC;IAC1B;IACA,OAAO1C,QAAQ,CAAC0C,IAAI,CAAC,CAAC,SAChB,CAAE,UAAAvC,KAAK;MAAA,OAAIC,OAAO,CAACC,MAAM,CAAC;QAAEF,KAAK,EAALA;MAAM,CAAC,CAAC;IAAA,CAAC,CAAC,CAC3CJ,IAAI,CAAE,UAAAG,GAAG;MAAA,OAAIE,OAAO,CAACC,MAAM,CAACH,GAAG,CAAC;IAAA,CAAC,CAAC;EACvC,CAAC,CAAC;AACN;AAEO,SAAS7B,UAAUA,CAACsB,QAAQ,EAAC;EAChC,OAAO6C,KAAK,CAAC,iBAAiB,EAAE;IAC5BG,MAAM,EAAE,MAAM;IACdC,IAAI,EAAEC,IAAI,CAACC,SAAS,CAAE;MAAEnD,QAAQ,EAARA;IAAS,CAAC,CAAC;IACnCoD,OAAO,EAAE,IAAIC,OAAO,CAAC;MACjB,cAAc,EAAE;IACpB,CAAC;EACL,CAAC,CAAC,SACI,CAAE;IAAA,OAAM5C,OAAO,CAACC,MAAM,CAAC;MAAEF,KAAK,EAAE;IAAc,CAAC,CAAC;EAAA,EAAC,CACtDJ,IAAI,CAAE,UAAAC,QAAQ,EAAI;IACf,IAAIA,QAAQ,CAACyC,EAAE,EAAE;MACb,OAAOzC,QAAQ,CAAC0C,IAAI,CAAC,CAAC;IACxB;IACF,OAAO1C,QAAQ,CAAC0C,IAAI,CAAC,CAAC,SAChB,CAAE,UAAAvC,KAAK;MAAA,OAAIC,OAAO,CAACC,MAAM,CAAC;QAAEF,KAAK,EAALA;MAAM,CAAC,CAAC;IAAA,CAAC,CAAC,CAC3CJ,IAAI,CAAE,UAAAG,GAAG;MAAA,OAAIE,OAAO,CAACC,MAAM,CAACH,GAAG,CAAC;IAAA,CAAC,CAAC;EACvC,CAAC,CAAC;AACN;AAEO,SAAS5B,WAAWA,CAAA,EAAE;EACzB,OAAOkE,KAAK,CAAC,iBAAiB,EAAE;IAC5BG,MAAM,EAAE,QAAQ;IAChBI,OAAO,EAAE,IAAIC,OAAO,CAAC;MACjB,cAAc,EAAE;IACpB,CAAC;EACL,CAAC,CAAC,SACI,CAAE;IAAA,OAAM5C,OAAO,CAACC,MAAM,CAAE;MAAEF,KAAK,EAAE;IAAc,CAAE,CAAC;EAAA,EAAC,CACxDJ,IAAI,CAAE,UAAAC,QAAQ,EAAI;IACf,IAAGA,QAAQ,CAACyC,EAAE,EAAC;MACX,OAAOzC,QAAQ,CAAC0C,IAAI,CAAC,CAAC;IAC1B;IAEA,OAAO1C,QAAQ,CAAC0C,IAAI,CAAC,CAAC,SAChB,CAAE,UAAAvC,KAAK;MAAA,OAAIC,OAAO,CAACC,MAAM,CAAC;QAACF,KAAK,EAALA;MAAK,CAAC,CAAC;IAAA,EAAC,CACxCJ,IAAI,CAAE,UAAAG,GAAG;MAAA,OAAIE,OAAO,CAACC,MAAM,CAACH,GAAG,CAAC;IAAA,EAAC;EACtC,CAAC,CAAC;AACN;AAEO,SAAS3B,YAAYA,CAACqC,OAAO,EAAC;EACjC,OAAO4B,KAAK,CAAC,iBAAiB,EAAE;IAC5BG,MAAM,EAAE,MAAM;IACdC,IAAI,EAAEC,IAAI,CAACC,SAAS,CAAC;MAAClC,OAAO,EAAPA;IAAO,CAAC,CAAC;IAC/BmC,OAAO,EAAE,IAAIC,OAAO,CAAC;MACjB,cAAc,EAAE;IACpB,CAAC;EACL,CAAC,CAAC,SACI,CAAE;IAAA,OAAM5C,OAAO,CAACC,MAAM,CAAE;MAAEF,KAAK,EAAE;IAAc,CAAE,CAAC;EAAA,EAAC,CACxDJ,IAAI,CAAE,UAAAC,QAAQ,EAAI;IACf,IAAGA,QAAQ,CAACyC,EAAE,EAAC;MACX,OAAOzC,QAAQ,CAAC0C,IAAI,CAAC,CAAC;IAC1B;IAEA,OAAO1C,QAAQ,CAAC0C,IAAI,CAAC,CAAC,SAChB,CAAE,UAAAvC,KAAK;MAAA,OAAIC,OAAO,CAACC,MAAM,CAAC;QAACF,KAAK,EAALA;MAAK,CAAC,CAAC;IAAA,EAAC,CACxCJ,IAAI,CAAE,UAAAG,GAAG;MAAA,OAAIE,OAAO,CAACC,MAAM,CAACH,GAAG,CAAC;IAAA,EAAC;EACtC,CAAC,CAAC;AACN;AAEO,SAAS1B,gBAAgBA,CAAA,EAAE;EAC9B,OAAOgE,KAAK,CAAC,iBAAiB,CAAC,SACzB,CAAE;IAAA,OAAMpC,OAAO,CAACC,MAAM,CAAE;MAAEF,KAAK,EAAE;IAAc,CAAE,CAAC;EAAA,EAAC,CACxDJ,IAAI,CAAE,UAAAC,QAAQ,EAAI;IACf,IAAGA,QAAQ,CAACyC,EAAE,EAAC;MACX,OAAOzC,QAAQ,CAAC0C,IAAI,CAAC,CAAC;IAC1B;IAEA,OAAO1C,QAAQ,CAAC0C,IAAI,CAAC,CAAC,SAChB,CAAE,UAAAvC,KAAK;MAAA,OAAIC,OAAO,CAACC,MAAM,CAAC;QAACF,KAAK,EAALA;MAAK,CAAC,CAAC;IAAA,EAAC,CACxCJ,IAAI,CAAE,UAAAG,GAAG;MAAA,OAAIE,OAAO,CAACC,MAAM,CAACH,GAAG,CAAC;IAAA,EAAC;EACtC,CAAC,CAAC;AACN;AAEO,SAASzB,cAAcA,CAAA,EAAE;EAC5B,OAAO+D,KAAK,CAAC,eAAe,CAAC,SACvB,CAAE;IAAA,OAAMpC,OAAO,CAACC,MAAM,CAAE;MAAEF,KAAK,EAAE;IAAc,CAAE,CAAC;EAAA,EAAC,CACxDJ,IAAI,CAAE,UAAAC,QAAQ,EAAI;IACf,IAAGA,QAAQ,CAACyC,EAAE,EAAC;MACX,OAAOzC,QAAQ,CAAC0C,IAAI,CAAC,CAAC;IAC1B;IAEA,OAAO1C,QAAQ,CAAC0C,IAAI,CAAC,CAAC,SAChB,CAAE,UAAAvC,KAAK;MAAA,OAAIC,OAAO,CAACC,MAAM,CAAC;QAACF,KAAK,EAALA;MAAK,CAAC,CAAC;IAAA,EAAC,CACxCJ,IAAI,CAAE,UAAAG,GAAG;MAAA,OAAIE,OAAO,CAACC,MAAM,CAACH,GAAG,CAAC;IAAA,EAAC;EACtC,CAAC,CAAC;AACN;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACjGuC;AAEvC,IAAMf,KAAK,GAAG;EACV,YAAY,EAAE,KAAK;EACnB,sBAAsB,EAAE,KAAK;EAC7B,mBAAmB,EAAE,KAAK;EAC1B,OAAO,EAAE,EAAE;EACX,UAAU,EAAE,EAAE;EACd,WAAW,EAAE,EAAE;EACf,UAAU,EAAE,EAAE;EACd,OAAO,EAAE,EAAE;EACX,gBAAgB,EAAE,EAAE;EACpB,mBAAmB,EAAE;AACzB,CAAC;AAEM,SAAST,KAAKA,CAAAQ,IAAA,EAAsB;EAAA,IAAnBS,QAAQ,GAAAT,IAAA,CAARS,QAAQ;IAAEM,KAAK,GAAAf,IAAA,CAALe,KAAK;EACnCd,KAAK,CAAC,YAAY,CAAC,GAAG,IAAI;EAC1BA,KAAK,CAAC,UAAU,CAAC,GAAGQ,QAAQ;EAC5BR,KAAK,CAAC,WAAW,CAAC,GAAGc,KAAK;AAC9B;AAEO,SAAStB,MAAMA,CAAA,EAAG;EACrBQ,KAAK,CAAC,YAAY,CAAC,GAAG,KAAK;EAC3BA,KAAK,CAAC,UAAU,CAAC,GAAG,EAAE;AAC1B;AAEO,SAASP,cAAcA,CAAC0B,QAAQ,EAAE;EACrCnB,KAAK,CAAC,UAAU,CAAC,GAAGmB,QAAQ;AAChC;AAEO,SAASzB,YAAYA,CAACmD,KAAK,EAAE;EAChC7C,KAAK,CAAC,OAAO,CAAC,GAAG6C,KAAK;AAC1B;AAEO,SAASlD,gBAAgBA,CAAA,EAAG;EAC/BK,KAAK,CAAC,sBAAsB,CAAC,GAAG,IAAI;EACpC;AACJ;AAEO,SAASJ,aAAaA,CAAA,EAAG;EAC5BI,KAAK,CAAC,mBAAmB,CAAC,GAAG,IAAI;AACrC;AAEO,SAAS8D,mBAAmBA,CAAA,EAAG;EAClC9D,KAAK,CAAC,sBAAsB,CAAC,GAAG,KAAK;AACzC;AAEO,SAAS+D,gBAAgBA,CAAA,EAAG;EAC/B/D,KAAK,CAAC,mBAAmB,CAAC,GAAG,KAAK;AACtC;AAGO,SAASgE,iBAAiBA,CAACC,EAAE,EAAE;EAClCjE,KAAK,CAAC,mBAAmB,CAAC,GAAGiE,EAAE;AACnC;AAEO,SAASC,cAAcA,CAACD,EAAE,EAAE;EAC/BjE,KAAK,CAAC,gBAAgB,CAAC,GAAGiE,EAAE;AAChC;AAEO,SAASE,SAASA,CAAA,EAAG;EACxB,IAAIC,aAAa,GAAG,EAAE;EACtBA,aAAa,CAACC,IAAI,CAACrE,KAAK,CAAC,mBAAmB,CAAC,CAAC;EAC9CoE,aAAa,CAACC,IAAI,CAACrE,KAAK,CAAC,gBAAgB,CAAC,CAAC;EAE3C,OAAOoE,aAAa;AAExB;AAEO,SAASE,aAAaA,CAAA,EAAG;EAC5BtE,KAAK,CAAC,mBAAmB,CAAC,GAAG,EAAE;EAC/BA,KAAK,CAAC,gBAAgB,CAAC,GAAG,EAAE;AAEhC;AAEO,SAASH,QAAQA,CAACmB,KAAK,EAAE;EAC5B,IAAI,CAACA,KAAK,EAAE;IACRhB,KAAK,CAACgB,KAAK,GAAG,EAAE;IAChB;EACJ;EACAhB,KAAK,CAACgB,KAAK,GAAGpC,gDAAQ,CAACoC,KAAK,CAAC,IAAIpC,gDAAQ,WAAQ;AACrD;AAEA,iEAAeoB,KAAK;;;;;;;;;;;;;;;;ACnFpB,IAAIgC,YAAY,GAAG,EAAE;AACrB,IAAIC,GAAG,GAAG,EAAE;AAEG,SAASlD,MAAMA,CAAAgB,IAAA,EAAoB;EAAA,IAAjBC,KAAK,GAAAD,IAAA,CAALC,KAAK;IAAEC,MAAM,GAAAF,IAAA,CAANE,MAAM;EAC1C+B,YAAY,GAAGhC,KAAK;EACpBiC,GAAG,GAAGhC,MAAM;EAEZ,IAAI+B,YAAY,CAACuC,oBAAoB,IAAIvC,YAAY,CAACE,UAAU,EAAE;IAC9DsC,iBAAiB,CAAC,CAAC;EACvB;EACA,IAAIxC,YAAY,CAACyC,iBAAiB,IAAIzC,YAAY,CAACE,UAAU,EAAE;IAC3DwC,cAAc,CAAC,CAAC;EACpB;AACJ;AAEA,SAASF,iBAAiBA,CAAA,EAAG;EACzB,IAAMG,SAAS,GAAGlE,QAAQ,CAACC,aAAa,CAAC,gBAAgB,CAAC;EAC1D,IAAM6B,IAAI,8BAA8B;EAExCoC,SAAS,CAACnC,SAAS,GAAGD,IAAI;AAC9B;AAEA,SAASmC,cAAcA,CAAA,EAAG;EACtB,IAAMC,SAAS,GAAGlE,QAAQ,CAACC,aAAa,CAAC,YAAY,CAAC;EACtD,IAAM6B,IAAI,8BAA8B;EAExCoC,SAAS,CAACnC,SAAS,GAAGD,IAAI;AAC9B;AAEO,SAASvD,YAAYA,CAACgB,KAAK,EAAE;EAChC,IAAM4E,UAAU,GAAGnE,QAAQ,CAACC,aAAa,CAAC,gBAAgB,CAAC;EAC3D,IAAMmE,WAAW,GAAG7E,KAAK,CAACmB,QAAQ;EAClC,IAAMsB,YAAY,GAAGoC,WAAW,CAACnC,GAAG,CAAC,UAAAC,IAAI;IAAA,oGAAAL,MAAA,CAA2FK,IAAI,CAAC7B,KAAK,iCAAAwB,MAAA,CAA4BK,IAAI,CAACnC,QAAQ,wCAAA8B,MAAA,CAAmCK,IAAI,CAAClB,OAAO;EAAA,CAAoB,CAAC,CAACmB,IAAI,CAAC,EAAE,CAAC,gCAAgC;EACpSgC,UAAU,CAACpC,SAAS,GAAGC,YAAY;EACnC;AACJ;AAEO,SAASxD,SAASA,CAACe,KAAK,EAAE;EAC7B,IAAM8E,QAAQ,GAAGrE,QAAQ,CAACC,aAAa,CAAC,YAAY,CAAC;EACrD,IAAImC,KAAK,GAAG7C,KAAK,CAAC6C,KAAK;EACvBA,KAAK,GAAGA,KAAK,CAACC,MAAM,CAAC,UAAAH,IAAI;IAAA,OAAIA,IAAI,CAACnC,QAAQ,KAAKR,KAAK,CAACQ,QAAQ;EAAA,EAAC;EAC9D,IAAMuC,UAAU,GAAGF,KAAK,CAACH,GAAG,CAAC,UAAAC,IAAI;IAAA,oFAAAL,MAAA,CAA4EK,IAAI,CAAC7B,KAAK,mCAAAwB,MAAA,CAA6BK,IAAI,CAACnC,QAAQ;EAAA,CAAoB,CAAC,CAACoC,IAAI,CAAC,GAAG,CAAC;EAChMkC,QAAQ,CAACtC,SAAS,GAAGO,UAAU;EAC/B;AACJ;;;;;;UC5CA;UACA;;UAEA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;;UAEA;UACA;;UAEA;UACA;UACA;;;;;WCtBA;WACA;WACA;WACA;WACA,yCAAyC,wCAAwC;WACjF;WACA;WACA;;;;;WCPA;;;;;WCAA;WACA;WACA;WACA,uDAAuD,iBAAiB;WACxE;WACA,gDAAgD,aAAa;WAC7D;;;;;;;;;;;;;;;;;ACFoB;AAQC;AAOJ;AAEY;AACuB;AACP;AAE7C,IAAM9C,MAAM,GAAGQ,QAAQ,CAACC,aAAa,CAAC,MAAM,CAAC;AAC7C5B,mDAAM,CAAC;EAAEkB,KAAK,EAALA,8CAAK;EAAEC,MAAM,EAANA;AAAO,CAAC,CAAC;AAEzB8E,WAAW,CAAC,YAAM;EACdrD,uDAAW,CAAC;IAAE1B,KAAK,EAALA,8CAAK;IAAEC,MAAM,EAANA;EAAO,CAAC,CAAC;EAC9B4B,oDAAQ,CAAC;IAAC7B,KAAK,EAALA,8CAAK;IAAEC,MAAM,EAANA;EAAM,CAAC,CAAC;AAC7B,CAAC,EAAE,IAAI,CAAC;AAERH,6DAAiB,CAAC;EAAEE,KAAK,EAALA,8CAAK;EAAEC,MAAM,EAANA;AAAO,CAAC,CAAC;AACpCoB,8DAAkB,CAAC;EAAErB,KAAK,EAALA,8CAAK;EAAEC,MAAM,EAANA;AAAO,CAAC,CAAC;AACrCsB,mEAAuB,CAAC;EAAEvB,KAAK,EAALA,8CAAK;EAAEC,MAAM,EAANA;AAAO,CAAC,CAAC;AAC1C+E,eAAe,CAAC,CAAC;;AAEjB;AACA,SAASA,eAAeA,CAAA,EAAG;EACvB5B,uDAAY,CAAC,CAAC,CACTxC,IAAI,CAAC,UAAAqE,OAAO,EAAI;IACb,IAAMzE,QAAQ,GAAGyE,OAAO,CAACzE,QAAQ;IACjC,IAAMM,KAAK,GAAGmE,OAAO,CAACnE,KAAK;IAC3BvB,6CAAK,CAAC;MAAEiB,QAAQ,EAARA,QAAQ;MAAEM,KAAK,EAALA;IAAM,CAAC,CAAC;IAE1BhC,mDAAM,CAAC;MAAEkB,KAAK,EAALA,8CAAK;MAAEC,MAAM,EAANA;IAAO,CAAC,CAAC;IACzB,OAAOZ,2DAAgB,CAAC,CAAC;EAC7B,CAAC,CAAC,SACI,CAAC,UAAA0B,GAAG,EAAI;IACV,IAAI,CAAAA,GAAG,aAAHA,GAAG,uBAAHA,GAAG,CAAEC,KAAK,MAAK7C,8CAAM,CAACC,YAAY,EAAE;MACpC,OAAO6C,OAAO,CAACC,MAAM,CAAC;QAAEF,KAAK,EAAEvC,8CAAM,CAACE;MAAW,CAAC,CAAC;IACvD;IACA,OAAOsC,OAAO,CAACC,MAAM,CAACH,GAAG,CAAC;EAC9B,CAAC,CAAC,CACDH,IAAI,CAAC,UAAAO,QAAQ,EAAI;IACd1B,sDAAc,CAAC0B,QAAQ,CAAC;IACxBnC,sDAAY,CAACgB,8CAAK,CAAC;IACnB,OAAOV,yDAAc,CAAC,CAAC;EAC3B,CAAC,CAAC,CACDsB,IAAI,CAAC,UAAAQ,KAAK,EAAI;IACX1B,oDAAY,CAAC0B,KAAK,CAAC;IACnBnC,mDAAS,CAACe,8CAAK,CAAC;IAChB;EACJ,CAAC,CAAC,SACI,CAAC,UAAAe,GAAG,EAAI;IACV,IAAI,CAAAA,GAAG,aAAHA,GAAG,uBAAHA,GAAG,CAAEC,KAAK,KAAIvC,8CAAM,CAACE,UAAU,EAAE;MACjCa,8CAAM,CAAC,CAAC;MACRV,mDAAM,CAAC;QAAEkB,KAAK,EAALA,8CAAK;QAAEC,MAAM,EAANA;MAAO,CAAC,CAAC;MACzB;IACJ;IACAJ,QAAQ,CAAC,CAAAkB,GAAG,aAAHA,GAAG,uBAAHA,GAAG,CAAEC,KAAK,KAAI,OAAO,CAAC;IAC/BlC,mDAAM,CAAC;MAAEkB,KAAK,EAALA,8CAAK;MAAEC,MAAM,EAANA;IAAO,CAAC,CAAC;EAC7B,CAAC,CAAC;AACV;AAAC,C","sources":["webpack://project2/./src/constants.js","webpack://project2/./src/listeners.js","webpack://project2/./src/render.js","webpack://project2/./src/services.js","webpack://project2/./src/state.js","webpack://project2/./src/utility.js","webpack://project2/webpack/bootstrap","webpack://project2/webpack/runtime/define property getters","webpack://project2/webpack/runtime/hasOwnProperty shorthand","webpack://project2/webpack/runtime/make namespace object","webpack://project2/./src/chat.js"],"sourcesContent":["// Might be SERVER_CODES and CLIENT_CODES if we had more and different constants\nexport const SERVER = {\n  AUTH_MISSING: 'auth-missing',\n  AUTH_INSUFFICIENT: 'auth-insufficient',\n  REQUIRED_USERNAME: 'required-username',\n  REQUIRED_TASK: 'required-task',\n  TASK_MISSING: 'noSuchId', // Someone was inconsistent!\n};\n\nexport const CLIENT = {\n  NETWORK_ERROR: 'networkError',\n  NO_SESSION: 'noSession',\n};\n\nexport const MESSAGES = {\n  // The [] below uses the variable value as the key\n  [CLIENT.NETWORK_ERROR]: 'Trouble connecting to the network.  Please try again',\n  // Here we use 'dog' to simulate a bad password\n  [SERVER.AUTH_INSUFFICIENT]: 'Your username/password combination does not match any records, please try again.',\n  [SERVER.REQUIRED_USERNAME]: 'Please enter a valid (letters and/or numbers) username',\n  [SERVER.REQUIRED_TASK]: 'Please enter the task to do',\n  default: 'Something went wrong.  Please try again',\n};\n","\nimport render from \"./render\";\nimport loader, {addsMessages, addsUsers} from \"./utility\";\nimport { fetchLogin, fetchLogout, fetchMessage, fetchMessageList, fetchUsersList } from \"./services\";\nimport { login, logout, recentMessages, currentUsers, addMessageLoader, addUserLoader, setError } from \"./state\";\nimport { SERVER } from \"./constants\";\n\nexport function addsLoginListener( { state, appEle} ){\n    appEle.addEventListener( 'submit', e => {\n        if(!e.target.classList.contains('login__form')){\n            return;\n        }\n\n        e.preventDefault();\n\n        const username = document.querySelector('#username').value;\n        //loader\n        fetchLogin(username)\n        .then( response => {\n            const image = response.image;\n            login({username, image});\n            render( {state, appEle} );\n\n            return fetchMessageList();\n        })\n        .catch( err => {\n            setError(err?.error || 'ERROR'); \n            render({ state, appEle });\n            return Promise.reject(err);\n          })\n        .then(messages => {\n            recentMessages(messages);\n            addsMessages(state);\n            return fetchUsersList();\n        })\n        .then(Users => {\n            currentUsers(Users);\n            addsUsers(state);\n            return;\n        })\n        .catch( err => {\n            setError(err?.error || 'ERROR'); \n            render({ state, appEle });\n            return\n          })\n    });\n}\n\nexport function addsLogoutListener( { state, appEle }){\n    appEle.addEventListener('click', e => {\n        if(!e.target.classList.contains('logout__button')){\n            return;\n        }\n\n        e.preventDefault();\n        logout();\n        fetchLogout()\n        .catch( err => {\n            setError(err?.error || 'ERROR'); \n            render({ state, appEle });\n          })\n        .then( response => {\n            render( { state, appEle});\n        })\n    });\n}\n\nexport function addsMessageSendListener( { state, appEle}){\n    appEle.addEventListener('submit', e => {\n        if(!e.target.classList.contains(\"chat__form\")){\n            return;\n        }\n\n        e.preventDefault();\n\n        const message = appEle.querySelector(\".form__message\").value;\n        appEle.querySelector(\".form__message\").value = '';\n        fetchMessage(message)\n        .catch( err => {\n            if( err?.error == SERVER.AUTH_MISSING ) { \n                setError(err?.error || 'ERROR'); \n                logout(); \n                render({ state, appEle });\n                return;\n              }\n            setError(err?.error || 'ERROR'); \n            render({ state, appEle });\n          })\n        .then( response => {\n            return fetchMessageList();\n        })\n        .then( response => {\n            recentMessages(response);\n            render( { state, appEle} );\n        })\n        .catch( err => {\n            if( err?.error == SERVER.AUTH_MISSING ) { \n                setError(err?.error || 'ERROR'); \n                logout(); \n                render({ state, appEle });\n                return;\n              }\n            setError(err?.error || 'ERROR'); \n            render({ state, appEle });\n          });\n\n    });\n}\n\nexport function getMessages({state, appEle}){\n    const messageEl = document.querySelector('.chat__message');\n    if (!messageEl) {\n        return;\n    }\n    addMessageLoader();\n    loader({state});\n\n    fetchMessageList()\n    .then( response => {\n        recentMessages(response);\n        addsMessages(state);\n        return;\n    })\n    .catch( err => {\n        if( err?.error == SERVER.AUTH_MISSING ) { \n            logout(); \n            render({ state, appEle });\n            return;\n          }\n        setError(err?.error || 'ERROR'); \n        render({ state, appEle });\n      });\n}\n\nexport function getUsers( {state, appEle } ){\n    const userEl = document.querySelector('.usersList');\n    if (!userEl) {\n        return;\n    }\n    addUserLoader();\n    loader({state});\n    fetchUsersList()\n    .then( response => {\n        currentUsers(response);\n        addsUsers(state);\n    })\n    .catch( err => {\n        setError(err?.error || 'ERROR'); \n        render({ state, appEle });\n      });\n}","let currentState = '';\nlet app = ''\n\nexport default function render({ state, appEle }) {\n    currentState = state;\n    app = appEle;\n\n    if (!currentState.isLoggedIn) {\n        addsLogin();\n    }\n    else {\n        addsChat();\n    }\n}\n\nfunction addsLogin() {\n    let errorHtml;\n    if (currentState.error) {\n        errorHtml = `<span class=\"error-message\">${currentState.error}</span>`;\n    }\n    const html =\n        `<div class=\"login\">\n            <h1 class=\"login__title\">Swift Whisper</h1>\n            <form class=\"login__form\">\n                <label class=\"login__label\">\n                    ${errorHtml || ``}\n                    <span>Username:</span>\n                    <input class=\"login__username\" value=\"\" id=\"username\" name=\"username\">\n                </label>\n                <button class=\"login__button\" type=\"submit\">Login</button>\n            </form>\n        </div>`;\n\n    app.innerHTML = html;\n}\n\nfunction addsChat() {\n    let errorHtml;\n    if (currentState.error) {\n        errorHtml = `<span class=\"error-message\">${currentState.error}</span>`;\n    }\n    const messages = currentState.messages;\n    const messageItems = messages.map(item => `<li><div class=\"message\"><div class=\"profile\"><img class=\"user-profile__avatar\" src=${item.image} alt=\"user photo\"/><span>${item.username}</span></div><span class=\"text\">${item.message}</span></div></li>`).join('') || `<p>no messages yet</p>`;\n\n    let users = currentState.users;\n    users = users.filter(item => item.username !== currentState.username);\n    const usersItems = users.map(item => `<li><div class=\"user-profile\"><img class=\"user-profile__avatar\" src=\"${item.image}\" alt=\"user photo\"/><span>${item.username}</span></div></li>`).join(' ');\n\n    const messageForm = `<form class=\"chat__form\">\n                            <label class=\"form__label\">\n                                <input class=\"form__message\" value=\"\" id=\"message\" name=\"message\" required placeholder=\"Enter message to send\">\n                            </label>\n                            <button class=\"form__button\" type=\"submit\">Send</button> \n                        </form>`;\n    const logout = `<button class=\"logout__button\">Logout</button>`\n    const messageList = `<ul class=\"chat__message\">${messageItems}${errorHtml || ``}</ul>`\n    const usersList = `<ul class=\"usersList\">${usersItems}</ul>`\n\n    const html =\n        `<div class=\"dashboard\">\n            <div class=\"sidebar\">\n                <div class=\"current-user\">\n                    <img class=\"current-user__avatar\" src=${currentState.userimage} alt=\"user photo\"/>\n                    <h2>${currentState.username}</h2>\n                </div>\n                <div class=\"active-users\">\n                    <h3>Active Users</h3>\n                    ${usersList}\n                </div>\n                <div class=\"logout\">\n                    ${logout}\n                </div>\n            </div>\n            <div class=\"chat-section\">\n                <div class=\"chat-section__title\">\n                    <h3>INFO6250</h3>\n                    <img class=\"user-profile__avatar\" src=\"images/memoji-group.png\" alt=\"group photo\"/>\n                </div>\n                <div class=\"chat-section__chat\">\n                    ${messageList}\n                    ${messageForm}\n                </div>\n            </div>\n        </div>`;\n\n    app.innerHTML = html;\n}","export function fetchSession(){\n    return fetch('/api/v1/session')\n    .catch( () => Promise.reject({ error: 'networkError' }))\n    .then( response => {\n        if (response.ok) {\n            return response.json();\n        }\n        return response.json()\n        .catch( error => Promise.reject({ error }) )\n        .then( err => Promise.reject(err) );\n    });\n}\n\nexport function fetchLogin(username){\n    return fetch('/api/v1/session', {\n        method: \"POST\",\n        body: JSON.stringify( { username }),\n        headers: new Headers({\n            'content-type': 'application/json',\n        })\n    })\n    .catch( () => Promise.reject({ error: 'networkError'}))\n    .then( response => {\n        if (response.ok) {\n            return response.json();\n          }\n        return response.json()\n        .catch( error => Promise.reject({ error }) )\n        .then( err => Promise.reject(err) );\n    })\n}\n\nexport function fetchLogout(){\n    return fetch('/api/v1/session', {\n        method: \"DELETE\",\n        headers: new Headers({\n            'content-type': 'application/json',\n        })\n    })\n    .catch( () => Promise.reject( { error: \"networkError\"} ))\n    .then( response => {\n        if(response.ok){\n            return response.json()\n        }\n\n        return response.json()\n        .catch( error => Promise.reject({error}))\n        .then( err => Promise.reject(err))\n    })\n}\n\nexport function fetchMessage(message){\n    return fetch('/api/v1/message', {\n        method: \"POST\",\n        body: JSON.stringify({message}),\n        headers: new Headers({\n            'content-type': 'application/json',\n        })\n    })\n    .catch( () => Promise.reject( { error: \"networkError\"} ))\n    .then( response => {\n        if(response.ok){\n            return response.json()\n        }\n\n        return response.json()\n        .catch( error => Promise.reject({error}))\n        .then( err => Promise.reject(err))\n    })\n}\n\nexport function fetchMessageList(){\n    return fetch('/api/v1/message')\n    .catch( () => Promise.reject( { error: \"networkError\"} ))\n    .then( response => {\n        if(response.ok){\n            return response.json()\n        }\n\n        return response.json()\n        .catch( error => Promise.reject({error}))\n        .then( err => Promise.reject(err))\n    })\n}\n\nexport function fetchUsersList(){\n    return fetch('/api/v1/users')\n    .catch( () => Promise.reject( { error: \"networkError\"} ))\n    .then( response => {\n        if(response.ok){\n            return response.json()\n        }\n\n        return response.json()\n        .catch( error => Promise.reject({error}))\n        .then( err => Promise.reject(err))\n    })\n}","import { MESSAGES } from \"./constants\";\n\nconst state = {\n    'isLoggedIn': false,\n    'isLoadingMessageData': false,\n    'isLoadingUserData': false,\n    'error': '',\n    'username': '',\n    'userimage': '',\n    'messages': [],\n    'users': [],\n    'userIntervalId': '',\n    'messageIntervalId': ''\n}\n\nexport function login({ username, image }) {\n    state['isLoggedIn'] = true;\n    state['username'] = username;\n    state['userimage'] = image;\n}\n\nexport function logout() {\n    state['isLoggedIn'] = false;\n    state['username'] = '';\n}\n\nexport function recentMessages(messages) {\n    state['messages'] = messages;\n}\n\nexport function currentUsers(users) {\n    state['users'] = users;\n}\n\nexport function addMessageLoader() {\n    state['isLoadingMessageData'] = true\n    return;\n}\n\nexport function addUserLoader() {\n    state['isLoadingUserData'] = true\n}\n\nexport function removeMessageLoader() {\n    state['isLoadingMessageData'] = false\n}\n\nexport function removeUserLoader() {\n    state['isLoadingUserData'] = false\n}\n\n\nexport function messageIntervalId(id) {\n    state['messageIntervalId'] = id\n}\n\nexport function userIntervalId(id) {\n    state['userIntervalId'] = id\n}\n\nexport function intervals() {\n    let intervalsList = [];\n    intervalsList.push(state['messageIntervalId']);\n    intervalsList.push(state['userIntervalId']);\n\n    return intervalsList;\n\n}\n\nexport function clearInterval() {\n    state['messageIntervalId'] = '';\n    state['userIntervalId'] = '';\n\n}\n\nexport function setError(error) {\n    if (!error) {\n        state.error = '';\n        return;\n    }\n    state.error = MESSAGES[error] || MESSAGES.default;\n}\n\nexport default state;","let currentState = '';\nlet app = '';\n\nexport default function loader({ state, appEle }) {\n    currentState = state;\n    app = appEle;\n\n    if (currentState.isLoadingMessageData && currentState.isLoggedIn) {\n        addsMessageLoader();\n    }\n    if (currentState.isLoadingUserData && currentState.isLoggedIn) {\n        addsUserLoader();\n    }\n}\n\nfunction addsMessageLoader() {\n    const loaderEle = document.querySelector('.chat__message');\n    const html = `<span>Loading Data</span>`\n\n    loaderEle.innerHTML = html;\n}\n\nfunction addsUserLoader() {\n    const loaderEle = document.querySelector('.usersList');\n    const html = `<span>Loading Data</span>`\n\n    loaderEle.innerHTML = html;\n}\n\nexport function addsMessages(state) {\n    const messageEle = document.querySelector('.chat__message');\n    const newMessages = state.messages;\n    const messageItems = newMessages.map(item => `<li><div class=\"message\"><div class=\"profile\"><img class=\"user-profile__avatar\" src=${item.image} alt=\"user photo\"/><span>${item.username}</span></div><span class=\"text\">${item.message}</span></div></li>`).join('') || `<p>No messages to show</p>`;\n    messageEle.innerHTML = messageItems;\n    return;\n}\n\nexport function addsUsers(state) {\n    const usersEle = document.querySelector('.usersList');\n    let users = state.users;\n    users = users.filter(item => item.username !== state.username);\n    const usersItems = users.map(item => `<li><div class=\"user-profile\"><img class=\"user-profile__avatar\" src=\"${item.image}\" alt=\"user photo\"/><span>${item.username}</span></div></li>`).join(' ');\n    usersEle.innerHTML = usersItems;\n    return;\n}","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","import {\n    fetchSession,\n    fetchMessageList,\n    fetchUsersList\n} from './services';\n\nimport {\n    addsLoginListener,\n    addsLogoutListener,\n    addsMessageSendListener,\n    getMessages,\n    getUsers,\n} from './listeners';\n\nimport state, {\n    login,\n    recentMessages,\n    currentUsers,\n    logout\n} from './state';\n\nimport render from './render'\nimport { addsMessages, addsUsers } from './utility';\nimport { CLIENT, SERVER } from './constants';\n\nconst appEle = document.querySelector('#app');\nrender({ state, appEle });\n\nsetInterval(() => {\n    getMessages({ state, appEle });\n    getUsers({state, appEle});\n}, 5000);\n\naddsLoginListener({ state, appEle });\naddsLogoutListener({ state, appEle });\naddsMessageSendListener({ state, appEle });\ncheckForSession();\n\n//inital or on refresh\nfunction checkForSession() {\n    fetchSession()\n        .then(session => {\n            const username = session.username;\n            const image = session.image;\n            login({ username, image });\n\n            render({ state, appEle });\n            return fetchMessageList();\n        })\n        .catch(err => {\n            if (err?.error === SERVER.AUTH_MISSING) {\n                return Promise.reject({ error: CLIENT.NO_SESSION }) \n            }\n            return Promise.reject(err); \n        })\n        .then(messages => {\n            recentMessages(messages);\n            addsMessages(state);\n            return fetchUsersList();\n        })\n        .then(Users => {\n            currentUsers(Users);\n            addsUsers(state);\n            return;\n        })\n        .catch(err => {\n            if (err?.error == CLIENT.NO_SESSION) { \n                logout(); \n                render({ state, appEle });\n                return;\n            }\n            setError(err?.error || 'ERROR'); \n            render({ state, appEle });\n        });\n};\n"],"names":["SERVER","AUTH_MISSING","AUTH_INSUFFICIENT","REQUIRED_USERNAME","REQUIRED_TASK","TASK_MISSING","CLIENT","NETWORK_ERROR","NO_SESSION","MESSAGES","_defineProperty","render","loader","addsMessages","addsUsers","fetchLogin","fetchLogout","fetchMessage","fetchMessageList","fetchUsersList","login","logout","recentMessages","currentUsers","addMessageLoader","addUserLoader","setError","addsLoginListener","_ref","state","appEle","addEventListener","e","target","classList","contains","preventDefault","username","document","querySelector","value","then","response","image","err","error","Promise","reject","messages","Users","addsLogoutListener","_ref2","addsMessageSendListener","_ref3","message","getMessages","_ref4","messageEl","getUsers","_ref5","userEl","currentState","app","isLoggedIn","addsLogin","addsChat","errorHtml","concat","html","innerHTML","messageItems","map","item","join","users","filter","usersItems","messageForm","messageList","usersList","userimage","fetchSession","fetch","ok","json","method","body","JSON","stringify","headers","Headers","removeMessageLoader","removeUserLoader","messageIntervalId","id","userIntervalId","intervals","intervalsList","push","clearInterval","isLoadingMessageData","addsMessageLoader","isLoadingUserData","addsUserLoader","loaderEle","messageEle","newMessages","usersEle","setInterval","checkForSession","session"],"sourceRoot":""}